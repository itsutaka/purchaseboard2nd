(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[569],{43238:function(e,r,n){Promise.resolve().then(n.bind(n,80873)),Promise.resolve().then(n.bind(n,50096)),Promise.resolve().then(n.bind(n,13390)),Promise.resolve().then(n.bind(n,55996)),Promise.resolve().then(n.bind(n,29928)),Promise.resolve().then(n.bind(n,85643)),Promise.resolve().then(n.bind(n,98785)),Promise.resolve().then(n.bind(n,91902)),Promise.resolve().then(n.bind(n,31718)),Promise.resolve().then(n.bind(n,50591)),Promise.resolve().then(n.bind(n,62068)),Promise.resolve().then(n.bind(n,59747)),Promise.resolve().then(n.bind(n,36624)),Promise.resolve().then(n.bind(n,74883)),Promise.resolve().then(n.bind(n,75292)),Promise.resolve().then(n.bind(n,47400)),Promise.resolve().then(n.bind(n,80876)),Promise.resolve().then(n.bind(n,6994)),Promise.resolve().then(n.bind(n,48524)),Promise.resolve().then(n.bind(n,1879)),Promise.resolve().then(n.bind(n,65362)),Promise.resolve().then(n.bind(n,54429)),Promise.resolve().then(n.bind(n,66890)),Promise.resolve().then(n.bind(n,12405)),Promise.resolve().then(n.bind(n,57883)),Promise.resolve().then(n.bind(n,41394)),Promise.resolve().then(n.bind(n,65819)),Promise.resolve().then(n.bind(n,5479)),Promise.resolve().then(n.bind(n,52531)),Promise.resolve().then(n.bind(n,91105)),Promise.resolve().then(n.bind(n,24811)),Promise.resolve().then(n.bind(n,92754)),Promise.resolve().then(n.bind(n,60342)),Promise.resolve().then(n.bind(n,62054)),Promise.resolve().then(n.bind(n,36946)),Promise.resolve().then(n.bind(n,27499)),Promise.resolve().then(n.bind(n,18114)),Promise.resolve().then(n.bind(n,94563)),Promise.resolve().then(n.bind(n,94891)),Promise.resolve().then(n.bind(n,60767)),Promise.resolve().then(n.bind(n,45652)),Promise.resolve().then(n.bind(n,75522)),Promise.resolve().then(n.bind(n,61832)),Promise.resolve().then(n.bind(n,21183)),Promise.resolve().then(n.bind(n,99193)),Promise.resolve().then(n.bind(n,50584)),Promise.resolve().then(n.bind(n,50551)),Promise.resolve().then(n.bind(n,4216)),Promise.resolve().then(n.bind(n,89948)),Promise.resolve().then(n.bind(n,59260)),Promise.resolve().then(n.bind(n,42999)),Promise.resolve().then(n.bind(n,45796)),Promise.resolve().then(n.bind(n,21967)),Promise.resolve().then(n.bind(n,57833)),Promise.resolve().then(n.bind(n,26440)),Promise.resolve().then(n.bind(n,98559)),Promise.resolve().then(n.bind(n,5641)),Promise.resolve().then(n.bind(n,74743)),Promise.resolve().then(n.bind(n,72341)),Promise.resolve().then(n.bind(n,23324)),Promise.resolve().then(n.bind(n,42789)),Promise.resolve().then(n.bind(n,27640)),Promise.resolve().then(n.bind(n,54548)),Promise.resolve().then(n.bind(n,2323)),Promise.resolve().then(n.bind(n,37903)),Promise.resolve().then(n.bind(n,86437)),Promise.resolve().then(n.bind(n,63752)),Promise.resolve().then(n.bind(n,37895)),Promise.resolve().then(n.bind(n,56819)),Promise.resolve().then(n.bind(n,88530)),Promise.resolve().then(n.bind(n,95294)),Promise.resolve().then(n.bind(n,7161)),Promise.resolve().then(n.bind(n,27994)),Promise.resolve().then(n.bind(n,44250)),Promise.resolve().then(n.bind(n,24898)),Promise.resolve().then(n.bind(n,52558)),Promise.resolve().then(n.bind(n,16352)),Promise.resolve().then(n.bind(n,2718)),Promise.resolve().then(n.bind(n,28803)),Promise.resolve().then(n.bind(n,8906)),Promise.resolve().then(n.bind(n,92326)),Promise.resolve().then(n.bind(n,46823)),Promise.resolve().then(n.bind(n,68106)),Promise.resolve().then(n.bind(n,80449)),Promise.resolve().then(n.bind(n,30249)),Promise.resolve().then(n.bind(n,79756)),Promise.resolve().then(n.bind(n,46743)),Promise.resolve().then(n.bind(n,13340)),Promise.resolve().then(n.bind(n,48420)),Promise.resolve().then(n.bind(n,78330)),Promise.resolve().then(n.bind(n,911)),Promise.resolve().then(n.bind(n,90495)),Promise.resolve().then(n.bind(n,20542)),Promise.resolve().then(n.bind(n,73188)),Promise.resolve().then(n.bind(n,98314)),Promise.resolve().then(n.bind(n,25117)),Promise.resolve().then(n.bind(n,22535)),Promise.resolve().then(n.bind(n,41387)),Promise.resolve().then(n.bind(n,97558)),Promise.resolve().then(n.bind(n,61222)),Promise.resolve().then(n.bind(n,76723)),Promise.resolve().then(n.bind(n,83378)),Promise.resolve().then(n.bind(n,85322)),Promise.resolve().then(n.bind(n,50817)),Promise.resolve().then(n.bind(n,38354)),Promise.resolve().then(n.bind(n,45488)),Promise.resolve().then(n.bind(n,92422)),Promise.resolve().then(n.bind(n,25112)),Promise.resolve().then(n.bind(n,49611)),Promise.resolve().then(n.bind(n,70479)),Promise.resolve().then(n.bind(n,52925)),Promise.resolve().then(n.bind(n,61910)),Promise.resolve().then(n.bind(n,31800)),Promise.resolve().then(n.bind(n,79634)),Promise.resolve().then(n.bind(n,80773)),Promise.resolve().then(n.bind(n,890)),Promise.resolve().then(n.bind(n,12240)),Promise.resolve().then(n.bind(n,73670)),Promise.resolve().then(n.bind(n,66602)),Promise.resolve().then(n.bind(n,7227)),Promise.resolve().then(n.bind(n,93256)),Promise.resolve().then(n.bind(n,92094)),Promise.resolve().then(n.bind(n,25983)),Promise.resolve().then(n.bind(n,12132)),Promise.resolve().then(n.bind(n,35790)),Promise.resolve().then(n.bind(n,51855)),Promise.resolve().then(n.bind(n,92208)),Promise.resolve().then(n.bind(n,75779)),Promise.resolve().then(n.bind(n,33995)),Promise.resolve().then(n.bind(n,74914)),Promise.resolve().then(n.bind(n,9569)),Promise.resolve().then(n.bind(n,37530)),Promise.resolve().then(n.bind(n,73150)),Promise.resolve().then(n.bind(n,46602)),Promise.resolve().then(n.bind(n,95687)),Promise.resolve().then(n.bind(n,27287)),Promise.resolve().then(n.bind(n,3975)),Promise.resolve().then(n.bind(n,70715)),Promise.resolve().then(n.bind(n,21808)),Promise.resolve().then(n.bind(n,37247)),Promise.resolve().then(n.bind(n,95730)),Promise.resolve().then(n.bind(n,53201)),Promise.resolve().then(n.bind(n,14099)),Promise.resolve().then(n.bind(n,32921)),Promise.resolve().then(n.bind(n,54755)),Promise.resolve().then(n.bind(n,30760)),Promise.resolve().then(n.bind(n,91380)),Promise.resolve().then(n.bind(n,89480)),Promise.resolve().then(n.bind(n,43170)),Promise.resolve().then(n.bind(n,48080)),Promise.resolve().then(n.bind(n,75213)),Promise.resolve().then(n.bind(n,4831)),Promise.resolve().then(n.bind(n,40404)),Promise.resolve().then(n.bind(n,72504)),Promise.resolve().then(n.bind(n,58763)),Promise.resolve().then(n.bind(n,89174)),Promise.resolve().then(n.bind(n,94483)),Promise.resolve().then(n.bind(n,88089)),Promise.resolve().then(n.bind(n,86508)),Promise.resolve().then(n.bind(n,30551)),Promise.resolve().then(n.bind(n,18926)),Promise.resolve().then(n.bind(n,20072)),Promise.resolve().then(n.bind(n,80708)),Promise.resolve().then(n.bind(n,35012)),Promise.resolve().then(n.bind(n,3360)),Promise.resolve().then(n.bind(n,36495)),Promise.resolve().then(n.bind(n,45624)),Promise.resolve().then(n.bind(n,27080)),Promise.resolve().then(n.bind(n,14584)),Promise.resolve().then(n.bind(n,55459)),Promise.resolve().then(n.bind(n,43813)),Promise.resolve().then(n.bind(n,96367)),Promise.resolve().then(n.bind(n,60370)),Promise.resolve().then(n.bind(n,73036)),Promise.resolve().then(n.bind(n,60825)),Promise.resolve().then(n.bind(n,89463)),Promise.resolve().then(n.bind(n,14680)),Promise.resolve().then(n.bind(n,74188)),Promise.resolve().then(n.bind(n,38114)),Promise.resolve().then(n.bind(n,70857)),Promise.resolve().then(n.bind(n,20513)),Promise.resolve().then(n.bind(n,75366)),Promise.resolve().then(n.bind(n,50226)),Promise.resolve().then(n.bind(n,56695)),Promise.resolve().then(n.bind(n,13686)),Promise.resolve().then(n.bind(n,47107)),Promise.resolve().then(n.bind(n,81169)),Promise.resolve().then(n.bind(n,56834)),Promise.resolve().then(n.bind(n,56672)),Promise.resolve().then(n.bind(n,72940)),Promise.resolve().then(n.bind(n,40006)),Promise.resolve().then(n.bind(n,56990)),Promise.resolve().then(n.bind(n,62587)),Promise.resolve().then(n.bind(n,39292)),Promise.resolve().then(n.bind(n,33289)),Promise.resolve().then(n.bind(n,37366)),Promise.resolve().then(n.bind(n,59512)),Promise.resolve().then(n.bind(n,52009)),Promise.resolve().then(n.bind(n,88999)),Promise.resolve().then(n.bind(n,44488)),Promise.resolve().then(n.bind(n,30485)),Promise.resolve().then(n.bind(n,2562)),Promise.resolve().then(n.bind(n,7083)),Promise.resolve().then(n.bind(n,32658)),Promise.resolve().then(n.bind(n,56629)),Promise.resolve().then(n.bind(n,72777)),Promise.resolve().then(n.bind(n,12136)),Promise.resolve().then(n.bind(n,14413)),Promise.resolve().then(n.bind(n,71506)),Promise.resolve().then(n.bind(n,60352)),Promise.resolve().then(n.bind(n,34146)),Promise.resolve().then(n.bind(n,87166)),Promise.resolve().then(n.bind(n,81284)),Promise.resolve().then(n.bind(n,44109)),Promise.resolve().then(n.bind(n,65948)),Promise.resolve().then(n.bind(n,30391)),Promise.resolve().then(n.bind(n,86114)),Promise.resolve().then(n.bind(n,5244)),Promise.resolve().then(n.bind(n,11535)),Promise.resolve().then(n.bind(n,78183)),Promise.resolve().then(n.bind(n,60366)),Promise.resolve().then(n.bind(n,64210)),Promise.resolve().then(n.bind(n,77255)),Promise.resolve().then(n.bind(n,90908)),Promise.resolve().then(n.bind(n,67133)),Promise.resolve().then(n.bind(n,2274)),Promise.resolve().then(n.bind(n,86063)),Promise.resolve().then(n.bind(n,15096)),Promise.resolve().then(n.bind(n,27340)),Promise.resolve().then(n.bind(n,54271)),Promise.resolve().then(n.bind(n,47550)),Promise.resolve().then(n.bind(n,5333)),Promise.resolve().then(n.bind(n,19691)),Promise.resolve().then(n.bind(n,44087)),Promise.resolve().then(n.bind(n,80198)),Promise.resolve().then(n.bind(n,31126)),Promise.resolve().then(n.bind(n,73953)),Promise.resolve().then(n.bind(n,25706)),Promise.resolve().then(n.bind(n,52517)),Promise.resolve().then(n.bind(n,82754)),Promise.resolve().then(n.bind(n,13439)),Promise.resolve().then(n.bind(n,18565)),Promise.resolve().then(n.bind(n,45839)),Promise.resolve().then(n.bind(n,59515)),Promise.resolve().then(n.bind(n,13370)),Promise.resolve().then(n.bind(n,58453)),Promise.resolve().then(n.bind(n,87888)),Promise.resolve().then(n.bind(n,62616)),Promise.resolve().then(n.bind(n,91482)),Promise.resolve().then(n.bind(n,50568)),Promise.resolve().then(n.bind(n,65784)),Promise.resolve().then(n.bind(n,51298)),Promise.resolve().then(n.bind(n,10632)),Promise.resolve().then(n.bind(n,35331)),Promise.resolve().then(n.bind(n,60373)),Promise.resolve().then(n.bind(n,58804)),Promise.resolve().then(n.bind(n,69345)),Promise.resolve().then(n.bind(n,52762)),Promise.resolve().then(n.bind(n,34008))},80873:function(e,r,n){"use strict";n.d(r,{default:function(){return w}});var i=n(57437),s=n(27640),o=n(60373),t=n(72940),l=n(21183),d=n(98314),h=n(35331),m=n(70857),v=n(26440),b=n(77255),P=n(15096),a=n(27340),c=n(86063),u=n(90908),x=n(67133),f=n(73953),j=n(61832),p=n(27648),g=n(2265),y=n(83464),T=n(50364),S=n(70575);function w(){let[e,r]=(0,g.useState)([]),[n,w]=(0,g.useState)(!0),[C,A]=(0,g.useState)("all"),{user:z,loading:E,isAdmin:k,isStaff:B}=(0,S.a)();(0,g.useEffect)(()=>{let e=async()=>{if(E||!z){w(!1),r([]);return}try{w(!0);let e=await z.getIdToken();k||B?console.log("Fetching all orders for Staff/Admin"):console.log("Fetching orders for regular user (backend should filter by UID)");let n=await y.Z.get("/api/orders",{headers:{Authorization:"Bearer ".concat(e)}});r(n.data)}catch(e){console.error("Error fetching orders:",e)}finally{w(!1)}};E||e()},[z,E,k,B]);let F="all"===C?e:e.filter(e=>e.status===C),I=e=>{switch(e){case"high":return"red";case"medium":return"orange";case"low":return"green";default:return"gray"}},_=e=>{switch(e){case"pending":return"yellow";case"approved":return"blue";case"purchased":return"purple";case"delivered":return"green";default:return"gray"}};return E||z?n?(0,i.jsx)(s.Center,{h:"200px",children:(0,i.jsx)(t.Spinner,{size:"xl"})}):(0,i.jsxs)(l.Box,{maxW:"container.xl",mx:"auto",children:[(0,i.jsxs)(d.Flex,{justify:"space-between",align:"center",mb:6,children:[(0,i.jsx)(h.Heading,{mb:6,children:"購物請求列表"}),(0,i.jsxs)(m.Select,{value:C,onChange:e=>A(e.target.value),width:"auto",minW:"150px",children:[(0,i.jsx)("option",{value:"all",children:"所有狀態"}),(0,i.jsx)("option",{value:"pending",children:"待審核"}),(0,i.jsx)("option",{value:"approved",children:"已批准"}),(0,i.jsx)("option",{value:"purchased",children:"已購買"}),(0,i.jsx)("option",{value:"delivered",children:"已送達"})]})]}),0===F.length?(0,i.jsxs)(l.Box,{textAlign:"center",py:10,children:[(0,i.jsx)(o.Text,{fontSize:"xl",color:"gray.500",children:"all"===C?"目前沒有購物請求。":'在狀態 "'.concat(C,'" 下沒有購物請求。')}),z&&(0,i.jsx)(p.default,{href:"/orders/create",passHref:!0,children:(0,i.jsx)(v.Button,{mt:4,colorScheme:"blue",children:"建立新的購物請求"})})]}):(0,i.jsxs)(b.Table,{variant:"simple",children:[(0,i.jsx)(P.Thead,{children:(0,i.jsxs)(a.Tr,{children:[(0,i.jsx)(c.Th,{children:"標題"}),(0,i.jsx)(c.Th,{children:"申請人"}),(0,i.jsx)(c.Th,{children:"數量"}),(0,i.jsx)(c.Th,{children:"優先級"}),(0,i.jsx)(c.Th,{children:"狀態"}),(0,i.jsx)(c.Th,{children:"建立時間"}),(0,i.jsx)(c.Th,{children:"操作"})]})}),(0,i.jsx)(u.Tbody,{children:F.map(e=>(0,i.jsxs)(a.Tr,{children:[(0,i.jsx)(x.Td,{children:e.title}),(0,i.jsx)(x.Td,{children:e.requestedBy.name}),(0,i.jsx)(x.Td,{children:e.quantity}),(0,i.jsx)(x.Td,{children:(0,i.jsx)(f.Tag,{size:"sm",colorScheme:I(e.priority),children:e.priority})}),(0,i.jsx)(x.Td,{children:(0,i.jsx)(j.Badge,{colorScheme:_(e.status),children:e.status})}),(0,i.jsx)(x.Td,{children:(0,T.Z)(new Date(e.createdAt),"yyyy-MM-dd HH:mm")}),(0,i.jsx)(x.Td,{children:(0,i.jsx)(p.default,{href:"/orders/".concat(e.id),passHref:!0,children:(0,i.jsx)(v.Button,{size:"sm",colorScheme:"blue",variant:"outline",children:"查看詳情"})})})]},e.id))})]})]}):(0,i.jsx)(s.Center,{h:"200px",children:(0,i.jsx)(o.Text,{children:"請登入以查看購物請求。"})})}},70575:function(e,r,n){"use strict";n.d(r,{AuthProvider:function(){return h},a:function(){return m}});var i=n(57437),s=n(2265),o=n(43301),t=n(94100),l=n(5978);let d=(0,s.createContext)(void 0),h=e=>{let{children:r}=e,[n,h]=(0,s.useState)(null),[m,v]=(0,s.useState)(!0),[b,P]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=(0,o.Aj)(t.U_,async e=>{if(h(e),e)try{let r=(0,l.JU)(t.$V,"users",e.uid),n=await (0,l.QT)(r);n.exists()?P(n.data()):(console.warn("User document not found in Firestore for UID:",e.uid),P(null))}catch(e){console.error("Error fetching user document:",e),P(null)}finally{v(!1)}else P(null),v(!1)});return v(!0),()=>e()},[]);let a=(null==b?void 0:b.role)==="admin",c=(null==b?void 0:b.role)==="staff"||a;return(0,i.jsx)(d.Provider,{value:{user:n,loading:m,userData:b,isAdmin:a,isStaff:c},children:r})},m=()=>{let e=(0,s.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},94100:function(e,r,n){"use strict";let i;n.d(r,{$V:function(){return d},U_:function(){return l}});var s=n(738),o=n(43301),t=n(5978);(0,s.C6)().length?(i=(0,s.Mq)(),console.log("Firebase Client SDK already initialized.")):(i=(0,s.ZF)({apiKey:"AIzaSyALS2VZcCRA8u7az9ZVNGFCtkLPvHjlERI",authDomain:"bqgracechurch.firebaseapp.com",projectId:"bqgracechurch",storageBucket:"bqgracechurch.firebasestorage.app",messagingSenderId:"751512628182",appId:"1:751512628182:web:7f6991cf5f066dfd821277"}),console.log("Firebase Client SDK initialized."));let l=(0,o.v0)(i),d=(0,t.ad)(i)},27648:function(e,r,n){"use strict";n.d(r,{default:function(){return s.a}});var i=n(72972),s=n.n(i)}},function(e){e.O(0,[358,58,387,815,731,972,145,464,364,971,117,744],function(){return e(e.s=43238)}),_N_E=e.O()}]);