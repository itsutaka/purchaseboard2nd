(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[271],{11416:function(e,t,n){Promise.resolve().then(n.bind(n,83711))},83711:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _}});var r=n(57437),i=n(13370),s=n(21183),l=n(42789),o=n(5641),a=n(62587),c=n(35331),u=n(60373),d=n(22535),h=n(97558),p=n(890),x=n(70857),f=n(26440),j=n(8906),m=n(66602),g=n(2265),v=n(99376),b=n(94100),S=n(43301),y=n(83464),C=n(27648);function _(){let[e,t]=(0,g.useState)(""),[n,_]=(0,g.useState)(""),[k,w]=(0,g.useState)(""),[F,I]=(0,g.useState)(""),[N,R]=(0,g.useState)(""),[z,E]=(0,g.useState)(!1),L=(0,v.useRouter)(),A=(0,i.useToast)(),q=async t=>{if(t.preventDefault(),!e||!n||!k){R("請填寫所有必填欄位");return}E(!0),R("");try{let t=(await (0,S.Xb)(b.U_,n,k)).user;if(console.log("Firebase Auth User created:",t),!t){console.error("User object is null after signup!"),R("註冊成功，但無法獲取用戶資訊，請稍後重試或聯繫管理員。"),E(!1);return}let r=await t.getIdToken();console.log("Acquired ID Token:",r);let i={Authorization:"Bearer ".concat(r),"Content-Type":"application/json"};console.log("Sending headers to /api/users:",i),await y.Z.post("/api/users",{name:e,department:F},{headers:i}),A({title:"註冊成功",description:"您的帳號已成功建立",status:"success",duration:3e3,isClosable:!0}),L.push("/auth/signin")}catch(e){var r,i;console.error("Signup process error:",e),e&&"object"==typeof e&&"code"in e?"auth/email-already-in-use"===e.code?R("電子郵件已被註冊"):"auth/weak-password"===e.code&&R("密碼強度不足，請至少輸入 6 個字元"):y.Z.isAxiosError(e)&&(null===(i=e.response)||void 0===i?void 0:null===(r=i.data)||void 0===r?void 0:r.message)?R("註冊後建立用戶文件失敗: "+e.response.data.message):R("註冊時發生錯誤: "+e.message)}finally{E(!1)}};return(0,r.jsx)(s.Box,{maxW:"md",mx:"auto",py:10,children:(0,r.jsx)(l.Card,{children:(0,r.jsx)(o.CardBody,{children:(0,r.jsxs)(a.Stack,{spacing:8,children:[(0,r.jsxs)(s.Box,{textAlign:"center",children:[(0,r.jsx)(c.Heading,{size:"lg",children:"註冊帳號"}),(0,r.jsx)(u.Text,{mt:2,color:"gray.600",children:"建立您的帳號以使用購物訂單追蹤系統"})]}),(0,r.jsx)("form",{onSubmit:q,children:(0,r.jsxs)(a.Stack,{spacing:4,children:[(0,r.jsxs)(d.FormControl,{isRequired:!0,children:[(0,r.jsx)(h.FormLabel,{children:"姓名"}),(0,r.jsx)(p.Input,{value:e,onChange:e=>t(e.target.value),placeholder:"請輸入您的姓名"})]}),(0,r.jsxs)(d.FormControl,{isRequired:!0,children:[(0,r.jsx)(h.FormLabel,{children:"電子郵件"}),(0,r.jsx)(p.Input,{type:"email",value:n,onChange:e=>_(e.target.value),placeholder:"your.email@example.com"})]}),(0,r.jsxs)(d.FormControl,{isRequired:!0,children:[(0,r.jsx)(h.FormLabel,{children:"密碼"}),(0,r.jsx)(p.Input,{type:"password",value:k,onChange:e=>w(e.target.value),placeholder:"至少 6 個字元"})]}),(0,r.jsxs)(d.FormControl,{children:[(0,r.jsx)(h.FormLabel,{children:"部門 (選填)"}),(0,r.jsxs)(x.Select,{placeholder:"選擇您的部門",value:F,onChange:e=>I(e.target.value),children:[(0,r.jsx)("option",{value:"engineering",children:"工程部"}),(0,r.jsx)("option",{value:"marketing",children:"市場行銷部"}),(0,r.jsx)("option",{value:"finance",children:"財務部"}),(0,r.jsx)("option",{value:"hr",children:"人力資源部"}),(0,r.jsx)("option",{value:"operations",children:"營運部"}),(0,r.jsx)("option",{value:"sales",children:"銷售部"}),(0,r.jsx)("option",{value:"it",children:"資訊技術部"}),(0,r.jsx)("option",{value:"customer_service",children:"客戶服務部"}),(0,r.jsx)("option",{value:"research",children:"研究發展部"}),(0,r.jsx)("option",{value:"other",children:"其他"})]})]}),N&&(0,r.jsx)(u.Text,{color:"red.500",fontSize:"sm",children:N}),(0,r.jsx)(f.Button,{colorScheme:"blue",type:"submit",isLoading:z,width:"full",mt:4,children:"註冊"})]})}),(0,r.jsx)(j.Divider,{}),(0,r.jsx)(s.Box,{textAlign:"center",children:(0,r.jsxs)(u.Text,{children:["已有帳號？"," ",(0,r.jsx)(m.Link,{as:C.default,href:"/auth/signin",color:"blue.500",children:"登入"})]})})]})})})})}},94100:function(e,t,n){"use strict";let r;n.d(t,{$V:function(){return a},U_:function(){return o}});var i=n(738),s=n(43301),l=n(5978);(0,i.C6)().length?(r=(0,i.Mq)(),console.log("Firebase Client SDK already initialized.")):(r=(0,i.ZF)({apiKey:"AIzaSyALS2VZcCRA8u7az9ZVNGFCtkLPvHjlERI",authDomain:"bqgracechurch.firebaseapp.com",projectId:"bqgracechurch",storageBucket:"bqgracechurch.firebasestorage.app",messagingSenderId:"751512628182",appId:"1:751512628182:web:7f6991cf5f066dfd821277"}),console.log("Firebase Client SDK initialized."));let o=(0,s.v0)(r),a=(0,l.ad)(r)},27648:function(e,t,n){"use strict";n.d(t,{default:function(){return i.a}});var r=n(72972),i=n.n(r)},99376:function(e,t,n){"use strict";var r=n(35475);n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}})},38114:function(e,t,n){"use strict";n.d(t,{SelectField:function(){return o}});var r=n(57437),i=n(24377),s=n(44109),l=n(81284);let o=(0,s.forwardRef)(function(e,t){let{children:n,placeholder:s,className:o,...a}=e;return(0,r.jsxs)(l.chakra.select,{...a,ref:t,className:(0,i.cx)("chakra-select",o),children:[s&&(0,r.jsx)("option",{value:"",children:s}),n]})});o.displayName="SelectField"},70857:function(e,t,n){"use strict";n.d(t,{Select:function(){return x}});var r=n(57437),i=n(22223),s=n(83614),l=n(76936),o=n(97291),a=n(2265),c=n(38114),u=n(61222),d=n(44109),h=n(81284),p=n(11535);let x=(0,d.forwardRef)((e,t)=>{var n;let a=(0,p.useMultiStyleConfig)("Select",e),{rootProps:d,placeholder:x,icon:f,color:j,height:g,h:v,minH:b,minHeight:S,iconColor:y,iconSize:C,..._}=(0,i.L)(e),[k,w]=(0,l.V)(_,s.oE),F=(0,u.useFormControl)(w),I={paddingEnd:"2rem",...a.field,_focus:{zIndex:"unset",...null===(n=a.field)||void 0===n?void 0:n._focus}};return(0,r.jsxs)(h.chakra.div,{className:"chakra-select__wrapper",__css:{width:"100%",height:"fit-content",position:"relative",color:j},...k,...d,children:[(0,r.jsx)(c.SelectField,{ref:t,height:null!=v?v:g,minH:null!=b?b:S,placeholder:x,...F,__css:I,children:e.children}),(0,r.jsx)(m,{"data-disabled":(0,o.P)(F.disabled),...(y||j)&&{color:y||j},__css:a.icon,...C&&{fontSize:C},children:f})]})});x.displayName="Select";let f=e=>(0,r.jsx)("svg",{viewBox:"0 0 24 24",...e,children:(0,r.jsx)("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),j=(0,h.chakra)("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),m=e=>{let{children:t=(0,r.jsx)(f,{}),...n}=e,i=(0,a.cloneElement)(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return(0,r.jsx)(j,{...n,className:"chakra-select__icon-wrapper",children:(0,a.isValidElement)(t)?i:null})};m.displayName="SelectIcon"},76936:function(e,t,n){"use strict";function r(e,t){let n={},r={};for(let[i,s]of Object.entries(e))t.includes(i)?n[i]=s:r[i]=s;return[n,r]}n.d(t,{V:function(){return r}})}},function(e){e.O(0,[358,58,387,815,731,972,464,971,117,744],function(){return e(e.s=11416)}),_N_E=e.O()}]);