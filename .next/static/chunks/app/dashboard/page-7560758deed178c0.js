(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{94364:function(e,t,r){Promise.resolve().then(r.bind(r,71720))},71720:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return _}});var n=r(57437),a=r(27640),s=r(72940),i=r(21183),l=r(35331),o=r(60373),c=r(26440),d=r(98314),u=r(61832),f=r(85322),h=r(42789),x=r(5641),m=r(44488),p=r(52009),g=r(88999),j=r(59512),y=r(73036),S=r(23324),b=r(62587),v=r(27648),C=r(70575),w=r(50364);let k={stats:{totalOrders:42,pendingOrders:15,completedOrders:27,completionRate:64},recentOrders:[{id:"1",title:"筆記型電腦",requestedBy:"張小明",status:"pending",date:"2023-09-15"},{id:"2",title:"顯示器",requestedBy:"李大方",status:"approved",date:"2023-09-14"},{id:"3",title:"無線滑鼠",requestedBy:"王小華",status:"delivered",date:"2023-09-13"}]};function _(){let{user:e,loading:t,userData:r,isAdmin:_,isStaff:N}=(0,C.a)(),{stats:B,recentOrders:R}=k,H=_||N?B:{totalOrders:B.totalOrders,pendingOrders:B.pendingOrders},A=e=>{switch(e){case"pending":return"yellow";case"approved":return"blue";case"purchased":return"purple";case"delivered":return"green";default:return"gray"}},T=e=>{switch(e){case"pending":return"待審核";case"approved":return"已批准";case"purchased":return"已購買";case"delivered":return"已送達";default:return e}};return t?(0,n.jsx)(a.Center,{h:"300px",children:(0,n.jsx)(s.Spinner,{size:"xl"})}):e?(0,n.jsxs)(i.Box,{maxW:"container.xl",mx:"auto",children:[(0,n.jsxs)(d.Flex,{justify:"space-between",align:"center",mb:6,children:[(0,n.jsx)(l.Heading,{children:"儀表板"}),(0,n.jsx)(v.default,{href:"/orders/create",passHref:!0,children:(0,n.jsx)(c.Button,{colorScheme:"blue",children:"建立訂單"})})]}),(0,n.jsxs)(i.Box,{mb:8,children:[(0,n.jsxs)(l.Heading,{size:"md",children:["歡迎, ",(null==r?void 0:r.name)||e.email,"!"]})," ",_?(0,n.jsx)(u.Badge,{ml:2,colorScheme:"purple",children:"管理員"}):N?(0,n.jsx)(u.Badge,{ml:2,colorScheme:"teal",children:"員工"}):(0,n.jsx)(u.Badge,{ml:2,colorScheme:"gray",children:"用戶"})]}),(0,n.jsxs)(f.SimpleGrid,{columns:{base:1,md:2,lg:4},spacing:6,mb:8,children:[(0,n.jsx)(h.Card,{children:(0,n.jsx)(x.CardBody,{children:(0,n.jsxs)(m.Stat,{children:[(0,n.jsx)(p.StatLabel,{children:"總訂單數"}),(0,n.jsx)(g.StatNumber,{children:H.totalOrders}),(0,n.jsx)(j.StatHelpText,{children:"所有採購請求"})]})})}),(0,n.jsx)(h.Card,{children:(0,n.jsx)(x.CardBody,{children:(0,n.jsxs)(m.Stat,{children:[(0,n.jsx)(p.StatLabel,{children:"待處理訂單"}),(0,n.jsx)(g.StatNumber,{children:H.pendingOrders}),(0,n.jsx)(j.StatHelpText,{children:"需要審核的請求"})]})})}),(0,n.jsx)(h.Card,{children:(0,n.jsx)(x.CardBody,{children:(0,n.jsxs)(m.Stat,{children:[(0,n.jsx)(p.StatLabel,{children:"已完成訂單"}),(0,n.jsx)(g.StatNumber,{children:B.completedOrders}),(0,n.jsx)(j.StatHelpText,{children:"已交付的採購"})]})})}),(0,n.jsx)(h.Card,{children:(0,n.jsx)(x.CardBody,{children:(0,n.jsxs)(m.Stat,{children:[(0,n.jsx)(p.StatLabel,{children:"完成率"}),(0,n.jsxs)(g.StatNumber,{children:[B.completionRate,"%"]}),(0,n.jsx)(y.Progress,{value:B.completionRate,colorScheme:"green",size:"sm",mt:2})]})})})]}),(0,n.jsxs)(h.Card,{mb:8,children:[(0,n.jsx)(S.CardHeader,{children:(0,n.jsx)(l.Heading,{size:"md",children:"最近訂單"})}),(0,n.jsxs)(x.CardBody,{children:[(0,n.jsx)(b.Stack,{divider:(0,n.jsx)(i.Box,{borderBottomWidth:"1px"}),spacing:4,children:R.filter(e=>_||N||r&&e.requestedBy===r.name).map(e=>(0,n.jsxs)(d.Flex,{justify:"space-between",align:"center",children:[(0,n.jsxs)(i.Box,{children:[(0,n.jsx)(v.default,{href:"/orders/".concat(e.id),passHref:!0,children:(0,n.jsx)(o.Text,{fontWeight:"semibold",_hover:{color:"blue.500"},cursor:"pointer",children:e.title})}),(0,n.jsxs)(o.Text,{fontSize:"sm",color:"gray.500",children:["申請人: ",e.requestedBy," • ",(0,w.Z)(new Date(e.date),"yyyy-MM-dd HH:mm")," "]})]}),(0,n.jsx)(u.Badge,{colorScheme:A(e.status),children:T(e.status)})]},e.id))}),(0,n.jsx)(i.Box,{mt:4,textAlign:"center",children:(0,n.jsx)(v.default,{href:"/orders",passHref:!0,children:(0,n.jsx)(c.Button,{variant:"outline",size:"sm",children:"查看所有訂單"})})})]})]})]}):(0,n.jsx)(a.Center,{h:"300px",children:(0,n.jsxs)(i.Box,{textAlign:"center",children:[(0,n.jsx)(l.Heading,{size:"lg",children:"需要登入"}),(0,n.jsx)(o.Text,{mt:2,color:"gray.600",children:"請登入您的帳號以查看儀表板內容。"}),(0,n.jsx)(v.default,{href:"/auth/signin",passHref:!0,children:(0,n.jsx)(c.Button,{mt:4,colorScheme:"blue",children:"前往登入"})})]})})}},70575:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return c},a:function(){return d}});var n=r(57437),a=r(2265),s=r(43301),i=r(94100),l=r(5978);let o=(0,a.createContext)(void 0),c=e=>{let{children:t}=e,[r,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0),[f,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=(0,s.Aj)(i.U_,async e=>{if(c(e),e)try{let t=(0,l.JU)(i.$V,"users",e.uid),r=await (0,l.QT)(t);r.exists()?h(r.data()):(console.warn("User document not found in Firestore for UID:",e.uid),h(null))}catch(e){console.error("Error fetching user document:",e),h(null)}finally{u(!1)}else h(null),u(!1)});return u(!0),()=>e()},[]);let x=(null==f?void 0:f.role)==="admin",m=(null==f?void 0:f.role)==="staff"||x;return(0,n.jsx)(o.Provider,{value:{user:r,loading:d,userData:f,isAdmin:x,isStaff:m},children:t})},d=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},94100:function(e,t,r){"use strict";let n;r.d(t,{$V:function(){return o},U_:function(){return l}});var a=r(738),s=r(43301),i=r(5978);(0,a.C6)().length?(n=(0,a.Mq)(),console.log("Firebase Client SDK already initialized.")):(n=(0,a.ZF)({apiKey:"AIzaSyALS2VZcCRA8u7az9ZVNGFCtkLPvHjlERI",authDomain:"bqgracechurch.firebaseapp.com",projectId:"bqgracechurch",storageBucket:"bqgracechurch.firebasestorage.app",messagingSenderId:"751512628182",appId:"1:751512628182:web:7f6991cf5f066dfd821277"}),console.log("Firebase Client SDK initialized."));let l=(0,s.v0)(n),o=(0,i.ad)(n)},27648:function(e,t,r){"use strict";r.d(t,{default:function(){return a.a}});var n=r(72972),a=r.n(n)},41154:function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.d(t,{Z:function(){return n}})},61832:function(e,t,r){"use strict";r.d(t,{Badge:function(){return c}});var n=r(57437),a=r(22223),s=r(24377),i=r(44109),l=r(11535),o=r(81284);let c=(0,i.forwardRef)(function(e,t){let r=(0,l.useStyleConfig)("Badge",e),{className:i,...c}=(0,a.L)(e);return(0,n.jsx)(o.chakra.span,{ref:t,className:(0,s.cx)("chakra-badge",e.className),...c,__css:{display:"inline-block",whiteSpace:"nowrap",verticalAlign:"middle",...r}})});c.displayName="Badge"},23324:function(e,t,r){"use strict";r.d(t,{CardHeader:function(){return o}});var n=r(57437),a=r(24377),s=r(74743),i=r(44109),l=r(81284);let o=(0,i.forwardRef)(function(e,t){let{className:r,...i}=e,o=(0,s.useCardStyles)();return(0,n.jsx)(l.chakra.div,{ref:t,className:(0,a.cx)("chakra-card__header",r),__css:o.header,...i})})},27640:function(e,t,r){"use strict";r.d(t,{AbsoluteCenter:function(){return o},Center:function(){return i}});var n=r(57437),a=r(81284),s=r(44109);let i=(0,a.chakra)("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});i.displayName="Center";let l={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}},o=(0,s.forwardRef)(function(e,t){let{axis:r="both",...s}=e;return(0,n.jsx)(a.chakra.div,{ref:t,__css:l[r],...s,position:"absolute"})})},98314:function(e,t,r){"use strict";r.d(t,{Flex:function(){return i}});var n=r(57437),a=r(44109),s=r(81284);let i=(0,a.forwardRef)(function(e,t){let{direction:r,align:a,justify:i,wrap:l,basis:o,grow:c,shrink:d,...u}=e;return(0,n.jsx)(s.chakra.div,{ref:t,__css:{display:"flex",flexDirection:r,alignItems:a,justifyContent:i,flexWrap:l,flexBasis:o,flexGrow:c,flexShrink:d},...u})});i.displayName="Flex"},83378:function(e,t,r){"use strict";r.d(t,{Grid:function(){return i}});var n=r(57437),a=r(44109),s=r(81284);let i=(0,a.forwardRef)(function(e,t){let{templateAreas:r,gap:a,rowGap:i,columnGap:l,column:o,row:c,autoFlow:d,autoRows:u,templateRows:f,autoColumns:h,templateColumns:x,...m}=e;return(0,n.jsx)(s.chakra.div,{ref:t,__css:{display:"grid",gridTemplateAreas:r,gridGap:a,gridRowGap:i,gridColumnGap:l,gridAutoColumns:h,gridColumn:o,gridRow:c,gridAutoFlow:d,gridAutoRows:u,gridTemplateRows:f,gridTemplateColumns:x},...m})});i.displayName="Grid"},85322:function(e,t,r){"use strict";r.d(t,{SimpleGrid:function(){return o}});var n=r(57437),a=r(80171),s=r(83378),i=r(78183),l=r(65948);let o=(0,r(44109).forwardRef)(function(e,t){let{columns:r,spacingX:o,spacingY:c,spacing:d,minChildWidth:u,...f}=e,h=(0,i.useTheme)(),x=u?(0,a.XQ)(u,e=>{let t=(0,l.getToken)("sizes",e,"number"==typeof e?"".concat(e,"px"):e)(h);return null===e?null:"repeat(auto-fit, minmax(".concat(t,", 1fr))")}):(0,a.XQ)(r,e=>null===e?null:"repeat(".concat(e,", minmax(0, 1fr))"));return(0,n.jsx)(s.Grid,{ref:t,gap:d,columnGap:o,rowGap:c,templateColumns:x,...f})});o.displayName="SimpleGrid"},73036:function(e,t,r){"use strict";r.d(t,{Progress:function(){return h},useProgressStyles:function(){return u}});var n=r(57437),a=r(22223),s=r(34008),i=r(41092),l=r(44109),o=r(81284),c=r(11535);let[d,u]=(0,s.createContext)({name:"ProgressStylesContext",errorMessage:"useProgressStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<Progress />\" "}),f=(0,l.forwardRef)((e,t)=>{let{min:r,max:a,value:s,isIndeterminate:l,role:c,...d}=e,f=(0,i.Wt)({value:s,min:r,max:a,isIndeterminate:l,role:c}),h={height:"100%",...u().filledTrack};return(0,n.jsx)(o.chakra.div,{ref:t,style:{width:"".concat(f.percent,"%"),...d.style},...f.bind,...d,__css:h})}),h=(0,l.forwardRef)((e,t)=>{var r;let{value:s,min:l=0,max:u=100,hasStripe:h,isAnimated:x,children:m,borderRadius:p,isIndeterminate:g,"aria-label":j,"aria-labelledby":y,"aria-valuetext":S,title:b,role:v,...C}=(0,a.L)(e),w=(0,c.useMultiStyleConfig)("Progress",e),k=null!=p?p:null===(r=w.track)||void 0===r?void 0:r.borderRadius,_={animation:"".concat(i.Ag," 1s linear infinite")},N={...!g&&h&&x&&_,...g&&{position:"absolute",willChange:"left",minWidth:"50%",animation:"".concat(i.YD," 1s ease infinite normal none running")}},B={overflow:"hidden",position:"relative",...w.track};return(0,n.jsx)(o.chakra.div,{ref:t,borderRadius:k,__css:B,...C,children:(0,n.jsxs)(d,{value:w,children:[(0,n.jsx)(f,{"aria-label":j,"aria-labelledby":y,"aria-valuetext":S,min:l,max:u,value:s,isIndeterminate:g,css:N,borderRadius:k,title:b,role:v}),m]})})});h.displayName="Progress"},41092:function(e,t,r){"use strict";r.d(t,{Ag:function(){return l},O2:function(){return a},U1:function(){return s},Wt:function(){return o},YD:function(){return i}});var n=r(3146);let a=(0,n.F4)({"0%":{strokeDasharray:"1, 400",strokeDashoffset:"0"},"50%":{strokeDasharray:"400, 400",strokeDashoffset:"-100"},"100%":{strokeDasharray:"400, 400",strokeDashoffset:"-260"}}),s=(0,n.F4)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),i=(0,n.F4)({"0%":{left:"-40%"},"100%":{left:"100%"}}),l=(0,n.F4)({from:{backgroundPosition:"1rem 0"},to:{backgroundPosition:"0 0"}});function o(e){let{value:t=0,min:r,max:n,valueText:a,getValueText:s,isIndeterminate:i,role:l="progressbar"}=e,o=(t-r)*100/(n-r);return{bind:{"data-indeterminate":i?"":void 0,"aria-valuemax":n,"aria-valuemin":r,"aria-valuenow":i?void 0:t,"aria-valuetext":(()=>{if(null!=t)return"function"==typeof s?s(t,o):a})(),role:l},percent:o,value:t}}},59512:function(e,t,r){"use strict";r.d(t,{StatHelpText:function(){return o}});var n=r(57437),a=r(24377),s=r(44488),i=r(44109),l=r(81284);let o=(0,i.forwardRef)(function(e,t){let r=(0,s.useStatStyles)();return(0,n.jsx)(l.chakra.dd,{ref:t,...e,className:(0,a.cx)("chakra-stat__help-text",e.className),__css:r.helpText})});o.displayName="StatHelpText"},52009:function(e,t,r){"use strict";r.d(t,{StatLabel:function(){return o}});var n=r(57437),a=r(24377),s=r(44488),i=r(44109),l=r(81284);let o=(0,i.forwardRef)(function(e,t){let r=(0,s.useStatStyles)();return(0,n.jsx)(l.chakra.dt,{ref:t,...e,className:(0,a.cx)("chakra-stat__label",e.className),__css:r.label})});o.displayName="StatLabel"},88999:function(e,t,r){"use strict";r.d(t,{StatNumber:function(){return o}});var n=r(57437),a=r(24377),s=r(44488),i=r(44109),l=r(81284);let o=(0,i.forwardRef)(function(e,t){let r=(0,s.useStatStyles)();return(0,n.jsx)(l.chakra.dd,{ref:t,...e,className:(0,a.cx)("chakra-stat__number",e.className),__css:{...r.number,fontFeatureSettings:"pnum",fontVariantNumeric:"proportional-nums"}})});o.displayName="StatNumber"},44488:function(e,t,r){"use strict";r.d(t,{Stat:function(){return f},useStatStyles:function(){return u}});var n=r(57437),a=r(22223),s=r(34008),i=r(24377),l=r(44109),o=r(11535),c=r(81284);let[d,u]=(0,s.createContext)({name:"StatStylesContext",errorMessage:"useStatStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<Stat />\" "}),f=(0,l.forwardRef)(function(e,t){let r=(0,o.useMultiStyleConfig)("Stat",e),s={position:"relative",flex:"1 1 0%",...r.container},{className:l,children:u,...f}=(0,a.L)(e);return(0,n.jsx)(d,{value:r,children:(0,n.jsx)(c.chakra.div,{ref:t,...f,className:(0,i.cx)("chakra-stat",l),__css:s,children:(0,n.jsx)("dl",{children:u})})})});f.displayName="Stat"}},function(e){e.O(0,[358,58,387,731,972,364,971,117,744],function(){return e(e.s=94364)}),_N_E=e.O()}]);